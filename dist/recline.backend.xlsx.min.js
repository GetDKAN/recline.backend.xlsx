/*! recline.backend.xlsx v0.1 */
var Excel={};!function(a){"use strict";a.__type__="Excel";var b="undefined"!=typeof jQuery&&jQuery.Deferred||_.Deferred;a.fetch=function(c){var d=new b,e=new XMLHttpRequest;return e.open("GET",c.url,!0),e.responseType="arraybuffer",e.onload=function(){for(var b={},f=new Uint8Array(e.response),g=[],h=0;h!==f.length;++h)g[h]=String.fromCharCode(f[h]);var i=g.join(""),j=XLSX.read(i,{type:"binary"}),k=c.sheet||_.first(_.keys(j.Sheets));b.fields=a.extractFields(j.Sheets[k]),b.useMemoryStore=!0,b.records=a.extractData(j.Sheets[k],b.fields),d.resolve(b)},e.send(),d.promise()},a.extractFields=function(a){var b,c=[],d=XLSX.utils.decode_range(a["!ref"]),e=d.s.r;for(b=d.s.c;b<=d.e.c;++b){var f=a[XLSX.utils.encode_cell({c:b,r:e})],g="UNKNOWN "+b;f&&f.t&&(g=XLSX.utils.format_cell(f)),c.push(g)}return c},a.extractData=function(a,b){var c,d,e,f=[],g=XLSX.utils.decode_range(a["!ref"]),h={};for(d=g.s.r+1;d<=g.e.r;++d){for(h={},c=g.s.c;c<=g.e.c;++c){var i=a[XLSX.utils.encode_cell({c:c,r:d})];i&&i.t&&(e=XLSX.utils.format_cell(i)),h[b[c]]=e}f.push(h)}return f}}(Excel);var recline=recline||{};recline.Backend=recline.Backend||{},recline.Backend.Excel=Excel;